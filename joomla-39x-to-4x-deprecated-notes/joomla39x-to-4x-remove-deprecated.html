<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>Joomla 3 to 4 - remove deprecated</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<style type="text/css">
		.table { background-color:#FFFFE0; border-collapse:collapse; width: 100%; color:#000;}
		.table th { background-color:#BDB76B; color:white;}
		.table td, .table th { padding:5px; border:0; }
		.table td { border:1px dotted #BDB76B;}

		.blue {color:blue;}
		.red {color:red;}
	</style>
</head>

<body>

<h2>Alternatives for Joomla39x deprecated classes, methods</h2>

<table class="table" border="1">
	<thead>
		<tr>
			<th>Area</th>
			<th>Old Code</th>
			<th>New Code</th>
		</tr>
	</thead>

	<tbody>
		<tr>
			<td>FieldsHelper::extract</td>

			<td>
<pre>


// Split context into component and optional section
$parts = FieldsHelper::extract($search);

if ($parts)
{
	$this->setstate('filter.component', $parts[0]);
	$this->setstate('filter.section', $parts[1]);
}
</pre>
			</td>

			<td>
<span class="blue">Add only for common package for J3.x and 4.x</span>
<pre>
if (JVERSION < '4.0.0')
{
	// Split context into component and optional section
	$parts = FieldsHelper::extract($search);

	if ($parts)
	{
		$this->setstate('filter.component', $parts[0]);
		$this->setstate('filter.section', $parts[1]);
	}
}
</pre>
			</td>
		</tr>
		<tr>
			<td>JApplicationHelper</td>

			<td>
<pre>


$data = JApplicationHelper::parseXMLInstallFile(JPATH_SITE .
'/plugins/emailalerts/abc.xml');
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Installer\Installer;

Installer::parseXMLInstallFile(JPATH_SITE .
'/plugins/emailalerts/abc.xml');
</pre>
			</td>
		</tr>

		<tr>
			<td>JArrayHelper</td>

			<td>
<pre>


JArrayHelper::toInteger($pks);
</pre>
			</td>

			<td>
<pre>
use Joomla\Utilities\ArrayHelper;

ArrayHelper::toInteger($pks);
</pre>
			</td>
		</tr>

		<tr>
			<td>JDatabase</td>
			<td>$db->query();</td>
			<td>$db->execute();</td>
		</tr>

		<tr>
			<td>JDatabase</td>

			<td>
<pre>
if ($db->getErrorNum())
{
	$this->setError($db->getErrorMsg()) ;

	return false;
}
</pre>
			</td>

			<td>
<pre>
try
{
	$db->execute();
}
catch (\RuntimeException $e)
{
	$this->setError($e->getMessage());

	return false;
}
</pre>
			</td>
		</tr>

		<tr>
			<td>JDispatcher (plugin trigger)</td>

			<td>
<pre>

$dispatcher = JDispatcher::getInstance();

JPluginHelper::importPlugin('jmailalert');
$dispatcher->trigger(
	'jmaOnAfterAlertSubscriptionDelete',
	array($context, (object) $subscription)
);
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Factory;
use Joomla\CMS\Plugin\PluginHelper;

PluginHelper::importPlugin('jmailalert');
Factory::getApplication()->triggerEvent(
	'jmaOnAfterAlertSubscriptionDelete',
	array($context, (object) $subscription)
);
</pre>
			</td>
		</tr>

		<tr>
			<td>JDocument</td>

			<td>
<pre>

$document->addStyleSheet(Uri::base() .
'/media/com_jmailalerts/css/jmailalerts.css');
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\HTML\HTMLHelper;

HTMLHelper::_('stylesheet',
'/media/com_jmailalerts/css/jmailalerts.css');
</pre>
			</td>
		</tr>

		<tr>
			<td>JDocument</td>

			<td>
<pre>

$document->addScript(Uri::root(true) .
'/plugins/system/tjupdates/tjupdates.js');
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\HTML\HTMLHelper;

HTMLHelper::_('script',
'/plugins/system/tjupdates/tjupdates.js');
</pre>
			</td>
		</tr>

		<tr>
			<td>JDocument addScriptDeclaration</td>

			<td>
<span class="red">Avoid inline javascript eg:</span>
<pre>

&lt;script type="text/javascript"&gt;
	jQuery(document).ready(function() {
		// blah blah
	});
&lt;/script&gt;
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Factory;

Factory::getDocument()->addScriptDeclaration('
	jQuery(document).ready(function() {
		// blah blah
	});
');
</pre>
			</td>
		</tr>

		<tr>
			<td>JError</td>

			<td>JError::raiseWarning(500, $e->getMessage());</td>

			<td>$this->setMessage($e->getMessage(), 'error');</td>
		</tr>

		<tr>
			<td>JError</td>

			<td>
<pre>

JError::raiseError(500, $model->getError());
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Factory;

$app = Factory::getApplication();
$app->enqueueMessage($model->getError(), 'error');
</pre>
			</td>
		</tr>

		<tr>
			<td>JFactory</td>

			<td>
<pre>


$app      = JFactory::getApplication();
$frommail = $app->getCfg('mailfrom');
$site     = $app->getCfg('sitename');
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Factory;

$app      = Factory::getApplication();
$frommail = $app->get('mailfrom');
$site     = $app->get('sitename');
</pre>
			</td>
		</tr>

		<tr>
			<td>JFactory</td>

			<td>
<pre>


$app = JFactory::getApplication();
if ($app->issite()) {}
if ($app->isAdmin()) {}
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Factory;

$app = Factory::getApplication();
if ($app->isClient('site')) {}
if ($app->isClient('administrator')) {}
</pre>
			</td>
		</tr>

		<tr>
			<td>JFactory</td>

			<td>$xml = Factory::getXML(JPATH_COMPONENT . '/jmailalerts.xml');</td>

			<td>$xml = simplexml_load_file(JPATH_COMPONENT . '/jmailalerts.xml');</td>
		</tr>


		<tr>
			<td>JFile</td>

			<td>File::read($cssfile);</td>

			<td>file_get_contents($cssfile);</td>
		</tr>

		<tr>
			<td>JFormField</td>

			<td>
<pre>
class JFormFieldLegend extends JFormField
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Form\FormField;

class JFormFieldLegend extends FormField
</pr>
			</td>
		</tr>

		<tr>
			<td>JHtml</td>

			<td>
<pre>

JHtml::_('behavior.modal', 'a.modal');
JHtml::_('behavior.tabstate');
JHtml::_('behavior.tooltip');
JHtml::_('bootstrap.tooltip');
JHtml::_('behavior.multiselect');
JHtml::_('form.token');
JHtml::_('formbehavior.chosen', 'select');
JHtml::_('jquery.framework');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.formvalidator');
JHtml::_('behavior.keepalive');
JHtml::_('searchtools.sort' ...)








</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\HTML\HTMLHelper;

// Removed 'behavior.tabstate' in J4
HTMLHelper::_('bootstrap.tooltip');
HTMLHelper::_('bootstrap.tooltip');
HTMLHelper::_('behavior.multiselect');
HTMLHelper::_('form.token');
HTMLHelper::_('formbehavior.chosen', 'select');
HTMLHelper::_('jquery.framework');
HTMLHelper::_('behavior.formvalidator');
HTMLHelper::_('behavior.formvalidator');
HTMLHelper::_('behavior.keepalive');
HTMLHelper::_('searchtools.sort'...)
</pre>

<span class="blue">Add only for common package for J3.x and 4.x</span>
<pre>
if (JVERSION < '4.0.0')
{
	HTMLHelper::_('behavior.tabstate');
}
</pre>
			</td>
		</tr>

		<tr>
			<td>JHtml::_('select.genericList', ...)</td>

			<td>
<pre>









return JHtml::_(
	'select.genericList',
	$alerts,
	'alerts',
	'class="inputbox"',
	'val',
	'text', ''
);
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\HTML\HTMLHelper;

$listOptions = array();
$listOptions['option.key']  = 'val';
$listOptions['option.text'] = 'text';
$listOptions['class']       = 'inputbox';
$listOptions['list.select'] = '';

return HTMLHelper::_(
	'select.genericlist',
	$alerts,
	'alerts',
	$listOptions
);
</pre>
			</td>
		</tr>

		<tr>
			<td>JHtml::_('jgrid.checkedout', ...)</td>

			<td>
<pre>


JHtml::_(
	'jgrid.checkedout',
	$i,
	$item->editor,
	$item->checked_out_time,
	'frequencies.',
	$canCheckin
);
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\HTML\HTMLHelper;

HTMLHelper::_(
	'jgrid.checkedout',
	$i,
	$item->editor,
	$item->checked_out_time,
	'frequencies.',
	$canCheckin
);
</pre>
			</td>
		</tr>

		<tr>
			<td>JHtml::_('sortablelist.sortable', ...)</td>

			<td>
<pre>


JHtml::_(
	'sortablelist.sortable',
	'frequencyList',
	'adminForm',
	strtolower($listDirn),
	$saveOrderingUrl
);
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\HTML\HTMLHelper;

HTMLHelper::_(
	'sortablelist.sortable',
	'frequencyList',
	'adminForm',
	strtolower($listDirn),
	$saveOrderingUrl
);
</pre>
			</td>
		</tr>


		<tr>
			<td>JHtmlSidebar::addEntry</td>

			<td>
<pre>


JHtmlSidebar::addEntry(
	Text::_('COM_JMAILALERTS_TITLE_DASHBOARD'),
	'index.php?option=com_jmailalerts&view=dashboard',
	$vName == 'dashboard'
);
</pre>
			</td>

			<td>
<span class="blue">Add only for common package for J3.x and 4.x</span>
<pre>
if (JVERSION < '4.0.0')
{
	JHtmlSidebar::addEntry(
		Text::_('COM_JMAILALERTS_TITLE_DASHBOARD'),
		'index.php?option=com_jmailalerts&view=dashboard',
		$vName == 'dashboard'
	);
}
</pre>
			</td>
		</tr>
		<tr>
			<td>JInstallerHelper</td>

			<td>
<pre>
jimport('joomla.installer.helper');
$queries = JInstallerHelper::splitSql($buffer);
</pre>
			</td>

			<td>
<pre>

$queries = \JDatabaseDriver::splitSql($buffer);
</pre>
			</td>
		</tr>

		<tr>
			<td>JParameter</td>

			<td>
<pre>

$params = new JParameter($jPlugin->params);
</pre>
			</td>

			<td>
<pre>
$params = new Registry;
$params->loadString($jPlugin->params);
</pre>
			</td>
		</tr>

		<tr>
			<td>JResponse</td>

			<td>
<pre>
$body = JResponse::getBody();
JResponse::setBody($body);
</pre>
			</td>

			<td>
<pre>
$app = Factory::getApplication();
$body = $app->getBody();
$app->setBody($body);
</pre>
			</td>
		</tr>

		<tr>
			<td>JToolBarHelper</td>

			<td>
<pre>


JToolBarHelper::(...);
eg: JToolBarHelper::addNew('frequency.add',
'JTOOLBAR_NEW');
</pre>
			</td>

			<td>
<pre>
use Joomla\CMS\Toolbar\ToolbarHelper;

ToolbarHelper::(...);
eg: ToolbarHelper::addNew('frequency.add',
'JTOOLBAR_NEW');
</pre>
			</td>
		</tr>

	</tbody>
</table>

</body>
</html>
